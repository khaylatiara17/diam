<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>acotz Group</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- AOS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="style.css" rel="stylesheet">
    <link rel="icon" href="aset/polos.png" type="image/png">
</head>
<body>
    <!-- Header -->
    <div id="header-placeholder"></div>

    <main id="main" class="main-content">
    <div class="container py-5 mt-5">  <!-- Changed mt-4 to mt-5 and added padding -->
        <div class="section-header text-center mb-5 mt-5" data-aos="fade-up">
            <h2><span class="text-color_1">Service</span> <span class="text-color_2">Application</span></h2>
            <p>Complete the form below and let Bacotz Group deliver exceptional service.</p>
        </div>

        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10" data-aos="fade-up">
                <!-- Alert Container -->
                <div id="alertContainer" class="mb-4"></div>
                
                <div class="card shadow-lg border-0 rounded-4 application-form">
                    <div class="card-header bg-gradient text-black p-4 rounded-top-4">
                        <h4 class="mb-0"><i class="bi bi-file-earmark-text me-2"></i>Formulir Pengajuan</h4>
                    </div>
                    <div class="card-body p-4 p-md-5">
                        <form id="applyForm" class="php-email-form">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">Nama Lengkap</label>
                                        <input type="text" class="form-control form-control-lg" name="fullName" required title="Nama Lengkap" placeholder="Masukkan nama lengkap">
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">NIK</label>
                                        <input type="text" class="form-control form-control-lg" name="nik" required 
                                               pattern="[0-9]{16}" maxlength="16" title="NIK" placeholder="Masukkan 16 digit NIK">
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">Email</label>
                                        <input type="email" class="form-control form-control-lg" name="email" required title="Email" placeholder="Masukkan alamat email">
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">No. Telepon</label>
                                        <input type="tel" class="form-control form-control-lg" name="phone" required title="No. Telepon" placeholder="Masukkan nomor telepon">
                                    </div>
                                </div>

                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">Jenis Layanan</label>
                                        <select class="form-select form-select-lg" name="service" required aria-label="Jenis Layanan">
                                            <option value="" selected disabled>Pilih Layanan</option>
                                            <option value="rumah">Pembiayaan Rumah</option>
                                            <option value="kendaraan">Pembiayaan Kendaraan</option>
                                            <option value="modal">Modal Kerja</option>
                                            <option value="investasi">Pembiayaan Investasi</option>
                                            <option value="renovasi">Pembiayaan Renovasi</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">Nilai Pengajuan</label>
                                        <div class="input-group input-group-lg">
                                            <span class="input-group-text">Rp</span>
                                            <input type="number" class="form-control" name="amount" required
                                                   min="10000000" step="1000000" 
                                                   title="Nilai Pengajuan" placeholder="Masukkan nilai pengajuan">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">Jangka Waktu</label>
                                        <select class="form-select form-select-lg" name="tenure" required aria-label="Jangka Waktu">
                                            <option value="1">1 Tahun</option>
                                            <option value="2">2 Tahun</option>
                                            <option value="3">3 Tahun</option>
                                            <option value="4">4 Tahun</option>
                                            <option value="5">5 Tahun</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <div class="form-group">
                                        <label class="form-label fw-bold mb-2">Tujuan Penggunaan</label>
                                        <textarea class="form-control" name="purpose" rows="4" required title="Tujuan Penggunaan" placeholder="Jelaskan tujuan penggunaan dana"></textarea>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <button type="submit" class="button-main w-100 py-3">
                                        <span class="button-text">Ajukan Sekarang</span>
                                        <span class="spinner-border spinner-border-sm d-none" role="status"></span>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </main>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Load header and footer
        async function loadComponents() {
            try {
                const [header, footer] = await Promise.all([
                    fetch('templates/header.html').then(r => r.ok ? r.text() : Promise.reject('Failed to load header')),
                    fetch('templates/footer.html').then(r => r.ok ? r.text() : Promise.reject('Failed to load footer'))
                ]);

                document.getElementById('header-placeholder').innerHTML = header;
                document.getElementById('footer-placeholder').innerHTML = footer;

                // Fix paths for root directory
                document.querySelectorAll('[src^="/"], [href^="/"]').forEach(el => {
                    const attr = el.hasAttribute('src') ? 'src' : 'href';
                    const value = el[attr];
                    if (!value.startsWith('http')) {
                        el[attr] = value.substring(1);
                    }
                });

            } catch (error) {
                console.error('Failed to load components:', error);
                showAlert('Failed to load page components. Please refresh.', 'danger');
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', loadComponents);

        // Initialize AOS
        AOS.init();

        // Show alert function
        function showAlert(message, type = 'danger') {
            const alertContainer = document.getElementById('alertContainer');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type} alert-dismissible fade show`;
            alert.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            `;
            alertContainer.appendChild(alert);

            // Auto dismiss after 5 seconds
            setTimeout(() => {
                alert.classList.remove('show');
                setTimeout(() => alert.remove(), 150);
            }, 5000);
        }

        // Form validation and submission
        document.getElementById('applyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            const buttonText = button.querySelector('.button-text');
            const spinner = button.querySelector('.spinner-border');

            try {
                if(!validateForm(e.target)) {
                    return;
                }

                button.disabled = true;
                buttonText.classList.add('d-none');
                spinner.classList.remove('d-none');

                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                showAlert('Pengajuan berhasil dikirim! Tim kami akan segera menghubungi Anda.', 'success');
                e.target.reset();
            } catch (error) {
                showAlert('Terjadi kesalahan. Silakan coba lagi.');
            } finally {
                button.disabled = false;
                buttonText.classList.remove('d-none');
                spinner.classList.add('d-none');
            }
        });

        // Enhanced form validation
        function validateForm(form) {
            const fields = form.querySelectorAll('input, select, textarea');
            let isValid = true;

            fields.forEach(field => {
                field.classList.remove('is-invalid');
                if (field.hasAttribute('required') && !field.value.trim()) {
                    field.classList.add('is-invalid');
                    showFieldError(field, 'Field ini wajib diisi');
                    isValid = false;
                } else if (field.name === 'nik' && !/^\d{16}$/.test(field.value)) {
                    field.classList.add('is-invalid');
                    showFieldError(field, 'NIK harus 16 digit angka');
                    isValid = false;
                } else if (field.name === 'phone' && !/^(\+62|62|0)[0-9]{9,12}$/.test(field.value)) {
                    field.classList.add('is-invalid');
                    showFieldError(field, 'Format nomor telepon tidak valid');
                    isValid = false;
                } else if (field.name === 'amount' && field.value < 10000000) {
                    field.classList.add('is-invalid');
                    showFieldError(field, 'Minimal pengajuan Rp 10.000.000');
                    isValid = false;
                }
            });

            return isValid;
        }

        function showFieldError(field, message) {
            const feedback = document.createElement('div');
            feedback.className = 'invalid-feedback';
            feedback.textContent = message;
            field.parentNode.appendChild(feedback);
        }
    </script>
</body>
</html>
